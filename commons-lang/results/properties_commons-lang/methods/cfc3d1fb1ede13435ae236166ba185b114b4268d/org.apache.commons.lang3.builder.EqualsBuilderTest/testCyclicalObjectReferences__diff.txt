/**                                                                                                    /**                                                                                                 
* Test cyclical object references which cause a StackOverflowException if                              * Test cyclical object references which cause a StackOverflowException if                           
* not handled properly. s. LANG-606                                                                    * not handled properly. s. LANG-606                                                                 
*/                                                                                                     */                                                                                                  
                                                                                                     | @Test                                                                                               
public void testCyclicalObjectReferences() {                                                           public void testCyclicalObjectReferences() {                                                        
TestObjectReference refX1 = new TestObjectReference(1);                                                TestObjectReference refX1 = new TestObjectReference(1);                                             
TestObjectReference x1 = new TestObjectReference(1);                                                   TestObjectReference x1 = new TestObjectReference(1);                                                
x1.setObjectReference(refX1);                                                                          x1.setObjectReference(refX1);                                                                       
refX1.setObjectReference(x1);                                                                          refX1.setObjectReference(x1);                                                                       
TestObjectReference refX2 = new TestObjectReference(1);                                                TestObjectReference refX2 = new TestObjectReference(1);                                             
TestObjectReference x2 = new TestObjectReference(1);                                                   TestObjectReference x2 = new TestObjectReference(1);                                                
x2.setObjectReference(refX2);                                                                          x2.setObjectReference(refX2);                                                                       
refX2.setObjectReference(x2);                                                                          refX2.setObjectReference(x2);                                                                       
TestObjectReference refX3 = new TestObjectReference(2);                                                TestObjectReference refX3 = new TestObjectReference(2);                                             
TestObjectReference x3 = new TestObjectReference(2);                                                   TestObjectReference x3 = new TestObjectReference(2);                                                
x3.setObjectReference(refX3);                                                                          x3.setObjectReference(refX3);                                                                       
refX3.setObjectReference(x3);                                                                          refX3.setObjectReference(x3);                                                                       
assertTrue(x1.equals(x2));                                                                             assertTrue(x1.equals(x2));                                                                          
assertNull(EqualsBuilder.getRegistry());                                                               assertNull(EqualsBuilder.getRegistry());                                                            
assertFalse(x1.equals(x3));                                                                            assertFalse(x1.equals(x3));                                                                         
assertNull(EqualsBuilder.getRegistry());                                                               assertNull(EqualsBuilder.getRegistry());                                                            
assertFalse(x2.equals(x3));                                                                            assertFalse(x2.equals(x3));                                                                         
assertNull(EqualsBuilder.getRegistry());                                                               assertNull(EqualsBuilder.getRegistry());                                                            
}                                                                                                      }                                                                                                   
