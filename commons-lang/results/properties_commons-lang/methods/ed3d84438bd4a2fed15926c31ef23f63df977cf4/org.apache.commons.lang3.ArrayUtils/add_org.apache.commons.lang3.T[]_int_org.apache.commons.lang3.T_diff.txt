/**                                                                                                    /**                                                                                                 
* &lt;p&gt;Inserts the specified element at the specified position in the array.                       * &lt;p&gt;Inserts the specified element at the specified position in the array.                    
* Shifts the element currently at that position (if any) and any subsequent                            * Shifts the element currently at that position (if any) and any subsequent                         
* elements to the right (adds one to their indices).&lt;/p&gt;                                         * elements to the right (adds one to their indices).&lt;/p&gt;                                      
*                                                                                                      *                                                                                                   
* &lt;p&gt;This method returns a new array with the same elements of the input                         * &lt;p&gt;This method returns a new array with the same elements of the input                      
* array plus the given element on the specified position. The component                                * array plus the given element on the specified position. The component                             
* type of the returned array is always the same as that of the input                                   * type of the returned array is always the same as that of the input                                
* array.&lt;/p&gt;                                                                                     * array.&lt;/p&gt;                                                                                  
*                                                                                                      *                                                                                                   
* &lt;p&gt;If the input array is &lt;code&gt;null&lt;/code&gt;, a new one element array is returned    * &lt;p&gt;If the input array is &lt;code&gt;null&lt;/code&gt;, a new one element array is returned 
*  whose component type is the same as the element.&lt;/p&gt;                                          *  whose component type is the same as the element.&lt;/p&gt;                                       
*                                                                                                      *                                                                                                   
* &lt;pre&gt;                                                                                          * &lt;pre&gt;                                                                                       
* ArrayUtils.add(null, 0, null)      = [null]                                                          * ArrayUtils.add(null, 0, null)      = [null]                                                       
* ArrayUtils.add(null, 0, "a")       = ["a"]                                                           * ArrayUtils.add(null, 0, "a")       = ["a"]                                                        
* ArrayUtils.add(["a"], 1, null)     = ["a", null]                                                     * ArrayUtils.add(["a"], 1, null)     = ["a", null]                                                  
* ArrayUtils.add(["a"], 1, "b")      = ["a", "b"]                                                      * ArrayUtils.add(["a"], 1, "b")      = ["a", "b"]                                                   
* ArrayUtils.add(["a", "b"], 3, "c") = ["a", "b", "c"]                                                 * ArrayUtils.add(["a", "b"], 3, "c") = ["a", "b", "c"]                                              
* &lt;/pre&gt;                                                                                         * &lt;/pre&gt;                                                                                      
*                                                                                                      *                                                                                                   
* @param array  the array to add the element to, may be &lt;code&gt;null&lt;/code&gt;                  * @param array  the array to add the element to, may be &lt;code&gt;null&lt;/code&gt;               
* @param index  the position of the new object                                                         * @param index  the position of the new object                                                      
* @param element  the object to add                                                                    * @param element  the object to add                                                                 
* @return A new array containing the existing elements and the new element                             * @return A new array containing the existing elements and the new element                          
* @throws IndexOutOfBoundsException if the index is out of range                                       * @throws IndexOutOfBoundsException if the index is out of range                                    
* (index &lt; 0 || index &gt; array.length).                                                           * (index &lt; 0 || index &gt; array.length).                                                        
*/                                                                                                     */                                                                                                  
@SuppressWarnings("unchecked")                                                                       |                                                                                                     
public static &lt;T&gt; T[] add(T[] array, int index, T element) {                                     public static &lt;T&gt; T[] add(T[] array, int index, T element) {                                  
Class&lt;?&gt; clss = null;                                                                            Class&lt;?&gt; clss = null;                                                                         
if (array != null) {                                                                                   if (array != null) {                                                                                
clss = array.getClass().getComponentType();                                                            clss = array.getClass().getComponentType();                                                         
} else if (element != null) {                                                                          } else if (element != null) {                                                                       
clss = element.getClass();                                                                             clss = element.getClass();                                                                          
} else {                                                                                               } else {                                                                                            
return (T[]) new Object[] { null };                                                                  | // TODO this is not type-safe - see LANG-571                                                        
                                                                                                     | final T[] emptyArray = (T[]) new Object[] { null };                                                 
                                                                                                     | return emptyArray;                                                                                  
}                                                                                                      }                                                                                                   
return (T[]) add(array, index, element, clss);                                                       | // the add method creates an array of type clss, which is type T                                    
                                                                                                     | @SuppressWarnings("unchecked")                                                                      
                                                                                                     | final T[] newArray = (T[]) add(array, index, element, clss);                                        
                                                                                                     | return newArray;                                                                                    
}                                                                                                      }                                                                                                   
