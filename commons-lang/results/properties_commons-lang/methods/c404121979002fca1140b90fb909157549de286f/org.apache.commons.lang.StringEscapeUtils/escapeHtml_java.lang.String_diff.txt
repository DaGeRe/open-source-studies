// HTML and XML                                                                                        // HTML and XML                                                                                     
// --------------------------------------------------------------------------                          // --------------------------------------------------------------------------                       
/**                                                                                                    /**                                                                                                 
* &lt;p&gt;Escapes the characters in a &lt;code&gt;String&lt;/code&gt; using HTML entities.&lt;/p&gt   * &lt;p&gt;Escapes the characters in a &lt;code&gt;String&lt;/code&gt; using HTML entities.&lt;/p&gt
*                                                                                                      *                                                                                                   
* &lt;p&gt;                                                                                            * &lt;p&gt;                                                                                         
* For example:                                                                                         * For example:                                                                                      
* &lt;/p&gt;                                                                                           * &lt;/p&gt;                                                                                        
* &lt;p&gt;&lt;code&gt;"bread" & "butter"&lt;/code&gt;&lt;/p&gt;                                       * &lt;p&gt;&lt;code&gt;"bread" & "butter"&lt;/code&gt;&lt;/p&gt;                                    
* becomes:                                                                                             * becomes:                                                                                          
* &lt;p&gt;                                                                                            * &lt;p&gt;                                                                                         
* &lt;code&gt;&amp;quot;bread&amp;quot; &amp;amp; &amp;quot;butter&amp;quot;&lt;/code&gt;.             * &lt;code&gt;&amp;quot;bread&amp;quot; &amp;amp; &amp;quot;butter&amp;quot;&lt;/code&gt;.          
* &lt;/p&gt;                                                                                           * &lt;/p&gt;                                                                                        
*                                                                                                      *                                                                                                   
* &lt;p&gt;Supports all known HTML 4.0 entities, including funky accents.                              * &lt;p&gt;Supports all known HTML 4.0 entities, including funky accents.                           
* Note that the commonly used apostrophe escape character (&amp;apos;)                                 * Note that the commonly used apostrophe escape character (&amp;apos;)                              
* is not a legal entity and so is not supported). &lt;/p&gt;                                           * is not a legal entity and so is not supported). &lt;/p&gt;                                        
*                                                                                                      *                                                                                                   
* @param str  the &lt;code&gt;String&lt;/code&gt; to escape, may be null                               * @param str  the &lt;code&gt;String&lt;/code&gt; to escape, may be null                            
* @return a new escaped &lt;code&gt;String&lt;/code&gt;, &lt;code&gt;null&lt;/code&gt; if null strin   * @return a new escaped &lt;code&gt;String&lt;/code&gt;, &lt;code&gt;null&lt;/code&gt; if null strin
*                                                                                                      *                                                                                                   
* @see #unescapeHtml(String)                                                                           * @see #unescapeHtml(String)                                                                        
* @see &lt;a href="http://hotwired.lycos.com/webmonkey/reference/special_characters/"&gt;ISO Entitie   * @see &lt;a href="http://hotwired.lycos.com/webmonkey/reference/special_characters/"&gt;ISO Entitie
* @see &lt;a href="http://www.w3.org/TR/REC-html32#latin1"&gt;HTML 3.2 Character Entities for ISO La   * @see &lt;a href="http://www.w3.org/TR/REC-html32#latin1"&gt;HTML 3.2 Character Entities for ISO La
* @see &lt;a href="http://www.w3.org/TR/REC-html40/sgml/entities.html"&gt;HTML 4.0 Character entity    * @see &lt;a href="http://www.w3.org/TR/REC-html40/sgml/entities.html"&gt;HTML 4.0 Character entity 
* @see &lt;a href="http://www.w3.org/TR/html401/charset.html#h-5.3"&gt;HTML 4.01 Character Reference   * @see &lt;a href="http://www.w3.org/TR/html401/charset.html#h-5.3"&gt;HTML 4.01 Character Reference
* @see &lt;a href="http://www.w3.org/TR/html401/charset.html#code-position"&gt;HTML 4.01 Code positi   * @see &lt;a href="http://www.w3.org/TR/html401/charset.html#code-position"&gt;HTML 4.01 Code positi
*/                                                                                                     */                                                                                                  
public static String escapeHtml(String str) {                                                          public static String escapeHtml(String str) {                                                       
if (str == null) {                                                                                   | return EscapeUtils.ESCAPE_HTML4.translate(str);                                                     
return null;                                                                                         |                                                                                                     
}                                                                                                      }                                                                                                   
try {                                                                                                |                                                                                                     
StringWriter writer = new StringWriter((int) (str.length() * 1.5));                                  |                                                                                                     
escapeHtml(writer, str);                                                                             |                                                                                                     
return writer.toString();                                                                            |                                                                                                     
} catch (IOException ioe) {                                                                          |                                                                                                     
// should be impossible                                                                              |                                                                                                     
throw new UnhandledException(ioe);                                                                   |                                                                                                     
}                                                                                                    |                                                                                                     
}                                                                                                    |                                                                                                     
