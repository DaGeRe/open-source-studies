/**                                                                                                    /**                                                                                                 
* &lt;p&gt;Wraps a single line of text, identifying words by &lt;code&gt;' '&lt;/code&gt;.&lt;/p&gt;   * &lt;p&gt;Wraps a single line of text, identifying words by &lt;code&gt;' '&lt;/code&gt;.&lt;/p&gt;
*                                                                                                      *                                                                                                   
* &lt;p&gt;Leading spaces on a new line are stripped.                                                  * &lt;p&gt;Leading spaces on a new line are stripped.                                               
* Trailing spaces are not stripped.&lt;/p&gt;                                                          * Trailing spaces are not stripped.&lt;/p&gt;                                                       
*                                                                                                      *                                                                                                   
* &lt;pre&gt;                                                                                          * &lt;pre&gt;                                                                                       
* WordUtils.wrap(null, *, *, *) = null                                                                 * WordUtils.wrap(null, *, *, *) = null                                                              
* WordUtils.wrap("", *, *, *) = ""                                                                     * WordUtils.wrap("", *, *, *) = ""                                                                  
* &lt;/pre&gt;                                                                                         * &lt;/pre&gt;                                                                                      
*                                                                                                      *                                                                                                   
* @param str  the String to be word wrapped, may be null                                               * @param str  the String to be word wrapped, may be null                                            
* @param wrapLength  the column to wrap the words at, less than 1 is treated as 1                      * @param wrapLength  the column to wrap the words at, less than 1 is treated as 1                   
* @param newLineStr  the string to insert for a new line,                                              * @param newLineStr  the string to insert for a new line,                                           
*  &lt;code&gt;null&lt;/code&gt; uses the system property line separator                               *  &lt;code&gt;null&lt;/code&gt; uses the system property line separator                            
* @param wrapLongWords  true if long words (such as URLs) should be wrapped                            * @param wrapLongWords  true if long words (such as URLs) should be wrapped                         
* @return a line with newlines inserted, &lt;code&gt;null&lt;/code&gt; if null input                   * @return a line with newlines inserted, &lt;code&gt;null&lt;/code&gt; if null input                
*/                                                                                                     */                                                                                                  
public static String wrap(String str, int wrapLength, String newLineStr, boolean wrapLongWords) {      public static String wrap(String str, int wrapLength, String newLineStr, boolean wrapLongWords) {   
if (str == null) {                                                                                     if (str == null) {                                                                                  
return null;                                                                                           return null;                                                                                        
}                                                                                                      }                                                                                                   
if (newLineStr == null) {                                                                              if (newLineStr == null) {                                                                           
newLineStr = SystemUtils.LINE_SEPARATOR;                                                               newLineStr = SystemUtils.LINE_SEPARATOR;                                                            
}                                                                                                      }                                                                                                   
if (wrapLength &lt; 1) {                                                                               if (wrapLength &lt; 1) {                                                                            
wrapLength = 1;                                                                                        wrapLength = 1;                                                                                     
}                                                                                                      }                                                                                                   
int inputLineLength = str.length();                                                                    int inputLineLength = str.length();                                                                 
int offset = 0;                                                                                        int offset = 0;                                                                                     
StringBuffer wrappedLine = new StringBuffer(inputLineLength + 32);                                   | StringBuilder wrappedLine = new StringBuilder(inputLineLength + 32);                                
while ((inputLineLength - offset) &gt; wrapLength) {                                                   while ((inputLineLength - offset) &gt; wrapLength) {                                                
if (str.charAt(offset) == ' ') {                                                                       if (str.charAt(offset) == ' ') {                                                                    
offset++;                                                                                              offset++;                                                                                           
continue;                                                                                              continue;                                                                                           
}                                                                                                      }                                                                                                   
int spaceToWrapAt = str.lastIndexOf(' ', wrapLength + offset);                                         int spaceToWrapAt = str.lastIndexOf(' ', wrapLength + offset);                                      
if (spaceToWrapAt &gt;= offset) {                                                                      if (spaceToWrapAt &gt;= offset) {                                                                   
// normal case                                                                                         // normal case                                                                                      
wrappedLine.append(str.substring(offset, spaceToWrapAt));                                              wrappedLine.append(str.substring(offset, spaceToWrapAt));                                           
wrappedLine.append(newLineStr);                                                                        wrappedLine.append(newLineStr);                                                                     
offset = spaceToWrapAt + 1;                                                                            offset = spaceToWrapAt + 1;                                                                         
} else {                                                                                               } else {                                                                                            
// really long word or URL                                                                             // really long word or URL                                                                          
if (wrapLongWords) {                                                                                   if (wrapLongWords) {                                                                                
// wrap really long word one line at a time                                                            // wrap really long word one line at a time                                                         
wrappedLine.append(str.substring(offset, wrapLength + offset));                                        wrappedLine.append(str.substring(offset, wrapLength + offset));                                     
wrappedLine.append(newLineStr);                                                                        wrappedLine.append(newLineStr);                                                                     
offset += wrapLength;                                                                                  offset += wrapLength;                                                                               
} else {                                                                                               } else {                                                                                            
// do not wrap really long word, just extend beyond limit                                              // do not wrap really long word, just extend beyond limit                                           
spaceToWrapAt = str.indexOf(' ', wrapLength + offset);                                                 spaceToWrapAt = str.indexOf(' ', wrapLength + offset);                                              
if (spaceToWrapAt &gt;= 0) {                                                                           if (spaceToWrapAt &gt;= 0) {                                                                        
wrappedLine.append(str.substring(offset, spaceToWrapAt));                                              wrappedLine.append(str.substring(offset, spaceToWrapAt));                                           
wrappedLine.append(newLineStr);                                                                        wrappedLine.append(newLineStr);                                                                     
offset = spaceToWrapAt + 1;                                                                            offset = spaceToWrapAt + 1;                                                                         
} else {                                                                                               } else {                                                                                            
wrappedLine.append(str.substring(offset));                                                             wrappedLine.append(str.substring(offset));                                                          
offset = inputLineLength;                                                                              offset = inputLineLength;                                                                           
}                                                                                                      }                                                                                                   
}                                                                                                      }                                                                                                   
}                                                                                                      }                                                                                                   
}                                                                                                      }                                                                                                   
// Whatever is left in line is short enough to just pass through                                       // Whatever is left in line is short enough to just pass through                                    
wrappedLine.append(str.substring(offset));                                                             wrappedLine.append(str.substring(offset));                                                          
return wrappedLine.toString();                                                                         return wrappedLine.toString();                                                                      
}                                                                                                      }                                                                                                   
