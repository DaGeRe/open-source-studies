/**                                                                                                    /**                                                                                                 
* Learn whether two annotations are equivalent; dynamically created                                    * Learn whether two annotations are equivalent; dynamically created                                 
* {@link Annotation} instances are always proxy objects which cannot be                                * {@link Annotation} instances are always proxy objects which cannot be                             
* depended upon to know how to implement {@link Annotation#equals(Object)}                             * depended upon to know how to implement {@link Annotation#equals(Object)}                          
* per spec.                                                                                            * per spec.                                                                                         
* @param a1 the first Annotation to compare                                                            * @param a1 the first Annotation to compare                                                         
* @param a2 the second Annotation to compare                                                           * @param a2 the second Annotation to compare                                                        
* @return Whether the two annotations are equal                                                        * @return Whether the two annotations are equal                                                     
*/                                                                                                     */                                                                                                  
public static boolean equals(Annotation a1, Annotation a2) {                                           public static boolean equals(Annotation a1, Annotation a2) {                                        
if (a1 == a2) {                                                                                        if (a1 == a2) {                                                                                     
return true;                                                                                           return true;                                                                                        
}                                                                                                      }                                                                                                   
if (a1 == null || a2 == null) {                                                                        if (a1 == null || a2 == null) {                                                                     
return false;                                                                                          return false;                                                                                       
}                                                                                                      }                                                                                                   
Class&lt;? extends Annotation&gt; type = a1.annotationType();                                          Class&lt;? extends Annotation&gt; type = a1.annotationType();                                       
Class&lt;? extends Annotation&gt; type2 = a2.annotationType();                                         Class&lt;? extends Annotation&gt; type2 = a2.annotationType();                                      
Validate.notNull(type, "Annotation %s with null annotationType()", a1);                                Validate.notNull(type, "Annotation %s with null annotationType()", a1);                             
Validate.notNull(type2, "Annotation %s with null annotationType()", a2);                               Validate.notNull(type2, "Annotation %s with null annotationType()", a2);                            
if (!type.equals(type2)) {                                                                             if (!type.equals(type2)) {                                                                          
return false;                                                                                          return false;                                                                                       
}                                                                                                      }                                                                                                   
try {                                                                                                  try {                                                                                               
for (Method m : type.getDeclaredMethods()) {                                                           for (Method m : type.getDeclaredMethods()) {                                                        
if (m.getParameterTypes().length == 0 && isValidAnnotationMemberType(m.getReturnType())) {             if (m.getParameterTypes().length == 0 && isValidAnnotationMemberType(m.getReturnType())) {          
Object v1 = m.invoke(a1);                                                                              Object v1 = m.invoke(a1);                                                                           
Object v2 = m.invoke(a2);                                                                              Object v2 = m.invoke(a2);                                                                           
if (!memberEquals(m.getReturnType(), v1, v2)) {                                                        if (!memberEquals(m.getReturnType(), v1, v2)) {                                                     
return false;                                                                                          return false;                                                                                       
}                                                                                                      }                                                                                                   
}                                                                                                      }                                                                                                   
}                                                                                                      }                                                                                                   
} catch (Exception e) {                                                                              | } catch (IllegalAccessException e) {                                                                
return false;                                                                                          return false;                                                                                       
                                                                                                     | } catch (InvocationTargetException e) {                                                             
                                                                                                     | return false;                                                                                       
}                                                                                                      }                                                                                                   
return true;                                                                                           return true;                                                                                        
}                                                                                                      }                                                                                                   
