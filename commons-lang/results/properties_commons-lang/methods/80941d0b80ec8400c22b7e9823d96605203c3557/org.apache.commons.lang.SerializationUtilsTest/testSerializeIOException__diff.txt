public void testSerializeIOException() throws Exception {                                              public void testSerializeIOException() throws Exception {                                           
// forces an IOException when the ObjectOutputStream is created, to test not closing the stream        // forces an IOException when the ObjectOutputStream is created, to test not closing the stream     
// in the finally block                                                                                // in the finally block                                                                             
OutputStream streamTest = new OutputStream() {                                                         OutputStream streamTest = new OutputStream() {                                                      
                                                                                                                                                                                                           
                                                                                                     | @Override                                                                                           
public void write(int arg0) throws IOException {                                                       public void write(int arg0) throws IOException {                                                    
throw new IOException(SERIALIZE_IO_EXCEPTION_MESSAGE);                                                 throw new IOException(SERIALIZE_IO_EXCEPTION_MESSAGE);                                              
}                                                                                                      }                                                                                                   
};                                                                                                     };                                                                                                  
try {                                                                                                  try {                                                                                               
SerializationUtils.serialize(iMap, streamTest);                                                        SerializationUtils.serialize(iMap, streamTest);                                                     
} catch (SerializationException e) {                                                                   } catch (SerializationException e) {                                                                
assertEquals("java.io.IOException: " + SERIALIZE_IO_EXCEPTION_MESSAGE, e.getMessage());                assertEquals("java.io.IOException: " + SERIALIZE_IO_EXCEPTION_MESSAGE, e.getMessage());             
}                                                                                                      }                                                                                                   
}                                                                                                      }                                                                                                   
