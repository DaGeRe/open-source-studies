/**                                                                                                    /**                                                                                                 
* Checks, whether the given file name is valid in the sense,                                           * Checks, whether the given file name is valid in the sense,                                        
* that it doesn't contain any NUL characters. If the file name                                         * that it doesn't contain any NUL characters. If the file name                                      
* is valid, it will be returned without any modifications. Otherwise,                                  * is valid, it will be returned without any modifications. Otherwise,                               
* an {@link InvalidFileNameException} is raised.                                                       * an {@link InvalidFileNameException} is raised.                                                    
*                                                                                                      *                                                                                                   
* @param pFileName The file name to check                                                              * @param pFileName The file name to check                                                           
* @return Unmodified file name, if valid.                                                              * @return Unmodified file name, if valid.                                                           
* @throws InvalidFileNameException The file name was found to be invalid.                              * @throws InvalidFileNameException The file name was found to be invalid.                           
*/                                                                                                     */                                                                                                  
public static String checkFileName(String pFileName) {                                                 public static String checkFileName(String pFileName) {                                              
if (pFileName != null && pFileName.indexOf('\u0000') != -1) {                                          if (pFileName != null && pFileName.indexOf('\u0000') != -1) {                                       
// pFileName.replace("\u0000", "\\0")                                                                  // pFileName.replace("\u0000", "\\0")                                                               
final StringBuffer sb = new StringBuffer();                                                          | final StringBuilder sb = new StringBuilder();                                                       
for (int i = 0; i &lt; pFileName.length(); i++) {                                                      for (int i = 0; i &lt; pFileName.length(); i++) {                                                   
char c = pFileName.charAt(i);                                                                          char c = pFileName.charAt(i);                                                                       
switch(c) {                                                                                            switch(c) {                                                                                         
case 0:                                                                                                case 0:                                                                                             
sb.append("\\0");                                                                                      sb.append("\\0");                                                                                   
break;                                                                                                 break;                                                                                              
default:                                                                                               default:                                                                                            
sb.append(c);                                                                                          sb.append(c);                                                                                       
break;                                                                                                 break;                                                                                              
}                                                                                                      }                                                                                                   
}                                                                                                      }                                                                                                   
throw new InvalidFileNameException(pFileName, "Invalid file name: " + sb);                             throw new InvalidFileNameException(pFileName, "Invalid file name: " + sb);                          
}                                                                                                      }                                                                                                   
return pFileName;                                                                                      return pFileName;                                                                                   
}                                                                                                      }                                                                                                   
