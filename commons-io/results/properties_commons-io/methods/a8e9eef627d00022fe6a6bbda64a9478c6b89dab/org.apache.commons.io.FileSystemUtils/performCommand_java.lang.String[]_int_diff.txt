List&lt;String&gt; performCommand(String[] cmdAttribs, int max) throws IOException {                 |                                                                                                     
List&lt;String&gt; lines = new ArrayList&lt;String&gt;(20);                                          |                                                                                                     
Process proc = null;                                                                                 |                                                                                                     
InputStream in = null;                                                                               |                                                                                                     
OutputStream out = null;                                                                             |                                                                                                     
InputStream err = null;                                                                              |                                                                                                     
BufferedReader inr = null;                                                                           |                                                                                                     
try {                                                                                                |                                                                                                     
proc = openProcess(cmdAttribs);                                                                      |                                                                                                     
in = proc.getInputStream();                                                                          |                                                                                                     
out = proc.getOutputStream();                                                                        |                                                                                                     
err = proc.getErrorStream();                                                                         |                                                                                                     
inr = new BufferedReader(new InputStreamReader(in));                                                 |                                                                                                     
String line = inr.readLine();                                                                        |                                                                                                     
while (line != null && lines.size() &lt; max) {                                                      |                                                                                                     
line = line.toLowerCase(Locale.ENGLISH).trim();                                                      |                                                                                                     
lines.add(line);                                                                                     |                                                                                                     
line = inr.readLine();                                                                               |                                                                                                     
}                                                                                                    |                                                                                                     
proc.waitFor();                                                                                      |                                                                                                     
if (proc.exitValue() != 0) {                                                                         |                                                                                                     
throw new IOException("Command line returned OS error code '" + proc.exitValue() + "' for command "  |                                                                                                     
}                                                                                                    |                                                                                                     
if (lines.size() == 0) {                                                                             |                                                                                                     
throw new IOException("Command line did not return any info " + "for command " + Arrays.asList(cmdAt |                                                                                                     
}                                                                                                    |                                                                                                     
return lines;                                                                                        |                                                                                                     
} catch (InterruptedException ex) {                                                                  |                                                                                                     
throw new IOException("Command line threw an InterruptedException '" + ex.getMessage() + "' for comm |                                                                                                     
} finally {                                                                                          |                                                                                                     
IOUtils.closeQuietly(in);                                                                            |                                                                                                     
IOUtils.closeQuietly(out);                                                                           |                                                                                                     
IOUtils.closeQuietly(err);                                                                           |                                                                                                     
IOUtils.closeQuietly(inr);                                                                           |                                                                                                     
if (proc != null) {                                                                                  |                                                                                                     
proc.destroy();                                                                                      |                                                                                                     
}                                                                                                    |                                                                                                     
}                                                                                                    |                                                                                                     
}                                                                                                    |                                                                                                     
