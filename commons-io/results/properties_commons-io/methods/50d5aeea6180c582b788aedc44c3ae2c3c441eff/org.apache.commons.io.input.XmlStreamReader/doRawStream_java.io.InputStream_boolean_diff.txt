private void doRawStream(InputStream is, boolean lenient) throws IOException {                         private void doRawStream(InputStream is, boolean lenient) throws IOException {                      
BOMInputStream bom = createBomStream(new BufferedInputStream(is, BUFFER_SIZE));                      | BOMInputStream bom = new BOMInputStream(new BufferedInputStream(is, BUFFER_SIZE), false, BOMS);     
BOMInputStream pis = createXmlStream(bom);                                                           | BOMInputStream pis = new BOMInputStream(bom, true, XML_GUESS_BYTES);                                
String bomEnc = (bom.hasBOM() ? bom.getBOM().getCharsetName() : null);                                 String bomEnc = (bom.hasBOM() ? bom.getBOM().getCharsetName() : null);                              
String xmlGuessEnc = (pis.hasBOM() ? pis.getBOM().getCharsetName() : null);                            String xmlGuessEnc = (pis.hasBOM() ? pis.getBOM().getCharsetName() : null);                         
String xmlEnc = getXmlProlog(pis, xmlGuessEnc);                                                        String xmlEnc = getXmlProlog(pis, xmlGuessEnc);                                                     
String encoding = calculateRawEncoding(bomEnc, xmlGuessEnc, xmlEnc, pis);                            | this.encoding = calculateRawEncoding(bomEnc, xmlGuessEnc, xmlEnc, pis);                             
prepareReader(pis, encoding);                                                                        | this.reader = new InputStreamReader(is, encoding);                                                  
}                                                                                                      }                                                                                                   
