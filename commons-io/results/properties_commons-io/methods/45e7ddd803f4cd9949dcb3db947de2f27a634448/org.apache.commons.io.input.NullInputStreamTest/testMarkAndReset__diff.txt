public void testMarkAndReset() throws Exception {                                                      public void testMarkAndReset() throws Exception {                                                   
int position = 0;                                                                                      int position = 0;                                                                                   
int readlimit = 10;                                                                                    int readlimit = 10;                                                                                 
InputStream input = new TestNullInputStream(100, true, false);                                         InputStream input = new TestNullInputStream(100, true, false);                                      
assertTrue("Mark Should be Supported", input.markSupported());                                         assertTrue("Mark Should be Supported", input.markSupported());                                      
try {                                                                                                  try {                                                                                               
input.reset();                                                                                         input.reset();                                                                                      
fail("Read limit exceeded, expected IOException ");                                                    fail("Read limit exceeded, expected IOException ");                                                 
} catch (Exception e) {                                                                              | } catch (IOException e) {                                                                           
assertEquals("No Mark IOException message", "No position has been marked", e.getMessage());            assertEquals("No Mark IOException message", "No position has been marked", e.getMessage());         
}                                                                                                      }                                                                                                   
for (; position &lt; 3; position++) {                                                                  for (; position &lt; 3; position++) {                                                               
assertEquals("Read Before Mark [" + position + "]", position, input.read());                           assertEquals("Read Before Mark [" + position + "]", position, input.read());                        
}                                                                                                      }                                                                                                   
input.mark(readlimit);                                                                                 input.mark(readlimit);                                                                              
for (int i = 0; i &lt; 3; i++) {                                                                       for (int i = 0; i &lt; 3; i++) {                                                                    
assertEquals("Read After Mark [" + i + "]", (position + i), input.read());                             assertEquals("Read After Mark [" + i + "]", (position + i), input.read());                          
}                                                                                                      }                                                                                                   
input.reset();                                                                                         input.reset();                                                                                      
for (int i = 0; i &lt; readlimit + 1; i++) {                                                           for (int i = 0; i &lt; readlimit + 1; i++) {                                                        
assertEquals("Read After Reset [" + i + "]", (position + i), input.read());                            assertEquals("Read After Reset [" + i + "]", (position + i), input.read());                         
}                                                                                                      }                                                                                                   
try {                                                                                                  try {                                                                                               
input.reset();                                                                                         input.reset();                                                                                      
fail("Read limit exceeded, expected IOException ");                                                    fail("Read limit exceeded, expected IOException ");                                                 
} catch (Exception e) {                                                                              | } catch (IOException e) {                                                                           
assertEquals("Read limit IOException message", "Marked position [" + position + "] is no longer vali   assertEquals("Read limit IOException message", "Marked position [" + position + "] is no longer vali
}                                                                                                      }                                                                                                   
}                                                                                                      }                                                                                                   
