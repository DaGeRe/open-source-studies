public static boolean wildcardMatch(final String filename, final String wildcardMatcher, IOCase case   public static boolean wildcardMatch(final String filename, final String wildcardMatcher, IOCase case
if (filename == null && wildcardMatcher == null) {                                                     if (filename == null && wildcardMatcher == null) {                                                  
return true;                                                                                           return true;                                                                                        
}                                                                                                      }                                                                                                   
if (filename == null || wildcardMatcher == null) {                                                     if (filename == null || wildcardMatcher == null) {                                                  
return false;                                                                                          return false;                                                                                       
}                                                                                                      }                                                                                                   
if (caseSensitivity == null) {                                                                         if (caseSensitivity == null) {                                                                      
caseSensitivity = IOCase.SENSITIVE;                                                                    caseSensitivity = IOCase.SENSITIVE;                                                                 
}                                                                                                      }                                                                                                   
final String[] wcs = splitOnTokens(wildcardMatcher);                                                   final String[] wcs = splitOnTokens(wildcardMatcher);                                                
boolean anyChars = false;                                                                              boolean anyChars = false;                                                                           
int textIdx = 0;                                                                                       int textIdx = 0;                                                                                    
int wcsIdx = 0;                                                                                        int wcsIdx = 0;                                                                                     
final Stack&lt;int[]&gt; backtrack = new Stack&lt;int[]&gt;();                                       | final Stack&lt;int[]&gt; backtrack = new Stack&lt;&gt;();                                           
do {                                                                                                   do {                                                                                                
if (backtrack.size() &gt; 0) {                                                                         if (backtrack.size() &gt; 0) {                                                                      
final int[] array = backtrack.pop();                                                                   final int[] array = backtrack.pop();                                                                
wcsIdx = array[0];                                                                                     wcsIdx = array[0];                                                                                  
textIdx = array[1];                                                                                    textIdx = array[1];                                                                                 
anyChars = true;                                                                                       anyChars = true;                                                                                    
}                                                                                                      }                                                                                                   
while (wcsIdx &lt; wcs.length) {                                                                       while (wcsIdx &lt; wcs.length) {                                                                    
if (wcs[wcsIdx].equals("?")) {                                                                         if (wcs[wcsIdx].equals("?")) {                                                                      
textIdx++;                                                                                             textIdx++;                                                                                          
if (textIdx &gt; filename.length()) {                                                                  if (textIdx &gt; filename.length()) {                                                               
break;                                                                                                 break;                                                                                              
}                                                                                                      }                                                                                                   
anyChars = false;                                                                                      anyChars = false;                                                                                   
} else if (wcs[wcsIdx].equals("*")) {                                                                  } else if (wcs[wcsIdx].equals("*")) {                                                               
anyChars = true;                                                                                       anyChars = true;                                                                                    
if (wcsIdx == wcs.length - 1) {                                                                        if (wcsIdx == wcs.length - 1) {                                                                     
textIdx = filename.length();                                                                           textIdx = filename.length();                                                                        
}                                                                                                      }                                                                                                   
} else {                                                                                               } else {                                                                                            
if (anyChars) {                                                                                        if (anyChars) {                                                                                     
textIdx = caseSensitivity.checkIndexOf(filename, textIdx, wcs[wcsIdx]);                                textIdx = caseSensitivity.checkIndexOf(filename, textIdx, wcs[wcsIdx]);                             
if (textIdx == NOT_FOUND) {                                                                            if (textIdx == NOT_FOUND) {                                                                         
break;                                                                                                 break;                                                                                              
}                                                                                                      }                                                                                                   
final int repeat = caseSensitivity.checkIndexOf(filename, textIdx + 1, wcs[wcsIdx]);                   final int repeat = caseSensitivity.checkIndexOf(filename, textIdx + 1, wcs[wcsIdx]);                
if (repeat &gt;= 0) {                                                                                  if (repeat &gt;= 0) {                                                                               
backtrack.push(new int[] { wcsIdx, repeat });                                                          backtrack.push(new int[] { wcsIdx, repeat });                                                       
}                                                                                                      }                                                                                                   
} else {                                                                                               } else {                                                                                            
if (!caseSensitivity.checkRegionMatches(filename, textIdx, wcs[wcsIdx])) {                             if (!caseSensitivity.checkRegionMatches(filename, textIdx, wcs[wcsIdx])) {                          
break;                                                                                                 break;                                                                                              
}                                                                                                      }                                                                                                   
}                                                                                                      }                                                                                                   
textIdx += wcs[wcsIdx].length();                                                                       textIdx += wcs[wcsIdx].length();                                                                    
anyChars = false;                                                                                      anyChars = false;                                                                                   
}                                                                                                      }                                                                                                   
wcsIdx++;                                                                                              wcsIdx++;                                                                                           
}                                                                                                      }                                                                                                   
if (wcsIdx == wcs.length && textIdx == filename.length()) {                                            if (wcsIdx == wcs.length && textIdx == filename.length()) {                                         
return true;                                                                                           return true;                                                                                        
}                                                                                                      }                                                                                                   
} while (backtrack.size() &gt; 0);                                                                     } while (backtrack.size() &gt; 0);                                                                  
return false;                                                                                          return false;                                                                                       
}                                                                                                      }                                                                                                   
