public static boolean wildcardMatch(String filename, String wildcardMatcher, IOCase caseSensitivity)   public static boolean wildcardMatch(String filename, String wildcardMatcher, IOCase caseSensitivity)
if (filename == null && wildcardMatcher == null) {                                                     if (filename == null && wildcardMatcher == null) {                                                  
return true;                                                                                           return true;                                                                                        
}                                                                                                      }                                                                                                   
if (filename == null || wildcardMatcher == null) {                                                     if (filename == null || wildcardMatcher == null) {                                                  
return false;                                                                                          return false;                                                                                       
}                                                                                                      }                                                                                                   
if (caseSensitivity == null) {                                                                         if (caseSensitivity == null) {                                                                      
caseSensitivity = IOCase.SENSITIVE;                                                                    caseSensitivity = IOCase.SENSITIVE;                                                                 
}                                                                                                      }                                                                                                   
filename = caseSensitivity.convertCase(filename);                                                      filename = caseSensitivity.convertCase(filename);                                                   
wildcardMatcher = caseSensitivity.convertCase(wildcardMatcher);                                        wildcardMatcher = caseSensitivity.convertCase(wildcardMatcher);                                     
String[] wcs = splitOnTokens(wildcardMatcher);                                                         String[] wcs = splitOnTokens(wildcardMatcher);                                                      
boolean anyChars = false;                                                                              boolean anyChars = false;                                                                           
int textIdx = 0;                                                                                       int textIdx = 0;                                                                                    
int wcsIdx = 0;                                                                                        int wcsIdx = 0;                                                                                     
Stack backtrack = new Stack();                                                                       | Stack&lt;int[]&gt; backtrack = new Stack&lt;int[]&gt;();                                            
do {                                                                                                   do {                                                                                                
if (backtrack.size() &gt; 0) {                                                                         if (backtrack.size() &gt; 0) {                                                                      
int[] array = (int[]) backtrack.pop();                                                               | int[] array = backtrack.pop();                                                                      
wcsIdx = array[0];                                                                                     wcsIdx = array[0];                                                                                  
textIdx = array[1];                                                                                    textIdx = array[1];                                                                                 
anyChars = true;                                                                                       anyChars = true;                                                                                    
}                                                                                                      }                                                                                                   
while (wcsIdx &lt; wcs.length) {                                                                       while (wcsIdx &lt; wcs.length) {                                                                    
if (wcs[wcsIdx].equals("?")) {                                                                         if (wcs[wcsIdx].equals("?")) {                                                                      
textIdx++;                                                                                             textIdx++;                                                                                          
anyChars = false;                                                                                      anyChars = false;                                                                                   
} else if (wcs[wcsIdx].equals("*")) {                                                                  } else if (wcs[wcsIdx].equals("*")) {                                                               
anyChars = true;                                                                                       anyChars = true;                                                                                    
if (wcsIdx == wcs.length - 1) {                                                                        if (wcsIdx == wcs.length - 1) {                                                                     
textIdx = filename.length();                                                                           textIdx = filename.length();                                                                        
}                                                                                                      }                                                                                                   
} else {                                                                                               } else {                                                                                            
if (anyChars) {                                                                                        if (anyChars) {                                                                                     
textIdx = filename.indexOf(wcs[wcsIdx], textIdx);                                                      textIdx = filename.indexOf(wcs[wcsIdx], textIdx);                                                   
if (textIdx == -1) {                                                                                   if (textIdx == -1) {                                                                                
break;                                                                                                 break;                                                                                              
}                                                                                                      }                                                                                                   
int repeat = filename.indexOf(wcs[wcsIdx], textIdx + 1);                                               int repeat = filename.indexOf(wcs[wcsIdx], textIdx + 1);                                            
if (repeat &gt;= 0) {                                                                                  if (repeat &gt;= 0) {                                                                               
backtrack.push(new int[] { wcsIdx, repeat });                                                          backtrack.push(new int[] { wcsIdx, repeat });                                                       
}                                                                                                      }                                                                                                   
} else {                                                                                               } else {                                                                                            
if (!filename.startsWith(wcs[wcsIdx], textIdx)) {                                                      if (!filename.startsWith(wcs[wcsIdx], textIdx)) {                                                   
break;                                                                                                 break;                                                                                              
}                                                                                                      }                                                                                                   
}                                                                                                      }                                                                                                   
textIdx += wcs[wcsIdx].length();                                                                       textIdx += wcs[wcsIdx].length();                                                                    
anyChars = false;                                                                                      anyChars = false;                                                                                   
}                                                                                                      }                                                                                                   
wcsIdx++;                                                                                              wcsIdx++;                                                                                           
}                                                                                                      }                                                                                                   
if (wcsIdx == wcs.length && textIdx == filename.length()) {                                            if (wcsIdx == wcs.length && textIdx == filename.length()) {                                         
return true;                                                                                           return true;                                                                                        
}                                                                                                      }                                                                                                   
} while (backtrack.size() &gt; 0);                                                                     } while (backtrack.size() &gt; 0);                                                                  
return false;                                                                                          return false;                                                                                       
}                                                                                                      }                                                                                                   
