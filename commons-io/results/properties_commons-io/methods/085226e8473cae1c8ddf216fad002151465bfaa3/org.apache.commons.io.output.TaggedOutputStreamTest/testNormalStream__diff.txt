@Test                                                                                                  @Test                                                                                               
public void testNormalStream() {                                                                       public void testNormalStream() {                                                                    
try {                                                                                                | try (final ByteArrayOutputStream buffer = new ByteArrayOutputStream()) {                            
final ByteArrayOutputStream buffer = new ByteArrayOutputStream();                                    | try (final OutputStream stream = new TaggedOutputStream(buffer)) {                                  
final OutputStream stream = new TaggedOutputStream(buffer);                                          |                                                                                                     
stream.write('a');                                                                                     stream.write('a');                                                                                  
stream.write(new byte[] { 'b' });                                                                      stream.write(new byte[] { 'b' });                                                                   
stream.write(new byte[] { 'c' }, 0, 1);                                                                stream.write(new byte[] { 'c' }, 0, 1);                                                             
stream.flush();                                                                                        stream.flush();                                                                                     
stream.close();                                                                                      | }                                                                                                   
assertEquals(3, buffer.size());                                                                        assertEquals(3, buffer.size());                                                                     
assertEquals('a', buffer.toByteArray()[0]);                                                            assertEquals('a', buffer.toByteArray()[0]);                                                         
assertEquals('b', buffer.toByteArray()[1]);                                                            assertEquals('b', buffer.toByteArray()[1]);                                                         
assertEquals('c', buffer.toByteArray()[2]);                                                            assertEquals('c', buffer.toByteArray()[2]);                                                         
} catch (final IOException e) {                                                                        } catch (final IOException e) {                                                                     
fail("Unexpected exception thrown");                                                                   fail("Unexpected exception thrown");                                                                
}                                                                                                      }                                                                                                   
}                                                                                                      }                                                                                                   
