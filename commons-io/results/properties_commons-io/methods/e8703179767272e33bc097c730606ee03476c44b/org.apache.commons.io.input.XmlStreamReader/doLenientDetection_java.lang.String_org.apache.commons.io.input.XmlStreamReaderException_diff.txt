private void doLenientDetection(String httpContentType, XmlStreamReaderException ex) throws IOExcept |                                                                                                     
if (httpContentType != null) {                                                                       |                                                                                                     
if (httpContentType.startsWith("text/html")) {                                                       |                                                                                                     
httpContentType = httpContentType.substring("text/html".length());                                   |                                                                                                     
httpContentType = "text/xml" + httpContentType;                                                      |                                                                                                     
try {                                                                                                |                                                                                                     
doHttpStream(ex.getInputStream(), httpContentType, true);                                            |                                                                                                     
ex = null;                                                                                           |                                                                                                     
} catch (XmlStreamReaderException ex2) {                                                             |                                                                                                     
ex = ex2;                                                                                            |                                                                                                     
}                                                                                                    |                                                                                                     
}                                                                                                    |                                                                                                     
}                                                                                                    |                                                                                                     
if (ex != null) {                                                                                    |                                                                                                     
String encoding = ex.getXmlEncoding();                                                               |                                                                                                     
if (encoding == null) {                                                                              |                                                                                                     
encoding = ex.getContentTypeEncoding();                                                              |                                                                                                     
}                                                                                                    |                                                                                                     
if (encoding == null) {                                                                              |                                                                                                     
encoding = (defaultEncoding == null) ? UTF_8 : defaultEncoding;                                      |                                                                                                     
}                                                                                                    |                                                                                                     
prepareReader(ex.getInputStream(), encoding);                                                        |                                                                                                     
}                                                                                                    |                                                                                                     
}                                                                                                    |                                                                                                     
